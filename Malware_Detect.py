import psutil
MALWARE_NAMES = [
    "malware.py", "stealer.py", "keylogger.py", "ransomware.py", "trojan.py",
    "botnet.py", "payload.py", "spyware.py", "infostealer.py", "remote_access.py",
    "phish.py", "dropper.py", "worm.py", "rat.py", "exploit.py", "shell.py",
    "backdoor.py", "darkbot.py", "clipper.py", "miner.py", "grabber.py",
    "scam.exe", "hacker.exe", "credential_stealer.exe"
]

def list_all_processes():
    """List all running processes."""
    print("\n**Listing All Running Processes:**\n")
    print(f"{'PID':<10}{'Process Name':<25}{'Command Line':<50}")
    print("=" * 90)

    for process in psutil.process_iter(['pid', 'name', 'cmdline']):
        try:
            pid = process.info['pid']
            name = process.info['name']
            cmdline = " ".join(process.info['cmdline']) if process.info['cmdline'] else "N/A"
            print(f"{pid:<10}{name:<25}{cmdline:<50}\n")
        except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
            continue  

def detect_malware():
    """Scan all running processes for known malware filenames."""
    print("\n **Scanning for Malware...** \n")
    suspicious_processes = []

    for process in psutil.process_iter(['pid', 'name', 'cmdline', 'username']):
        try:
            cmdline = process.info['cmdline']
            if cmdline and any(malware in " ".join(cmdline).lower() for malware in MALWARE_NAMES):
                suspicious_processes.append({
                    "PID": process.info['pid'],
                    "Name": process.info['name'],
                    "Cmdline": cmdline,
                    "User": process.info['username']
                })
        except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
            continue 

    if suspicious_processes:
        print("\n**Malware Detected!**")
        for proc in suspicious_processes:
            print(f" PID: {proc['PID']}, Name: {proc['Name']}, Cmdline: {proc['Cmdline']}, User: {proc['User']}")
        return True
    else:
        print(" No malware detected.")
        return False

if __name__ == "__main__":
    list_all_processes() 
    
    if detect_malware():
        print("\n Take immediate action to terminate the malicious process!")
    else:
        print("\n No malware detected. System appears clean.")
